## DDL(数据定义语言)
* 对库和表的管理，包括创建、修改、删除等

### 库的管理
1. 库的创建
    * 语法：`create database 库名`
    * 避免库重复创建的容错性处理
        1. `create database if not exists 库名`

2. 库的修改
    * 一般不进行库的修改，最多修改字符集
    * `alter databese 库名 character set 字符集`

3. 库的删除
    * `drop database 库名`
    * 避免重复删除同一个库的容错性处理
        1. `drop database if exists 库名`

### 表的管理
1. 表的创建（create）
    * 语法
    ```sql
    create table [if exists] 表名(
        字段名 字段类型[(长度),约束],
        字段名 字段类型[(长度),约束],
        ....
    )
    ```

    * 标准建表语法
    
      ```sql
      CREATE TABLE `t_wxuser_trade_log` (
        id int(11) NOT NULL AUTO_INCREMENT COMMENT '序号',
        order_id bigint(20) NOT NULL COMMENT '订单ID：微秒时间戳+4位随机数（18位）',
        ordertype tinyint(4) NOT NULL DEFAULT '0',
        order_date int(11) NOT NULL ,
        accounttime datetime DEFAULT NULL,
        payid varchar(50) DEFAULT NULL COMMENT '支付单号：pay+微秒时间戳+4位随机数（18位）',
        trademoney decimal(18,6) DEFAULT NULL,
        PRIMARY KEY (`id`)
      ) ENGINE=InnoDB AUTO_INCREMENT=556536 DEFAULT CHARSET=utf8 COMMENT='用户交易记录日志表'
      ```
    
      
    
2. 表的修改（alter）
    * 修改字段名
      
        1. `alter table 表名 change column(列) 原始字段名 新字段名 字段类型`
        
    * 修改字段类型或约束
      
        1. `alter table 表名 modify column 字段名 新类型`
        
    * 添加新字段
      
    1. `alter table 表名 add column 字段名 字段类型`
       
    * 删除字段名
      
        1. `alter table 表名 drop column 字段名`
        
    * 修改表名
      
        1. `alter table 表名 rename to 新表名`
        
    * 设置自增长主键的初始值
    
        ```mysql
        alter table test AUTO_INCREMENT = 1000
        ```
    
        
    
3. 表的删除（drop）
    * 语法
        1. `drop table 表名`或`drop table if exists 表名`

4. 表的复制
    * 复制表的结构
        
    1. `create table 表名 like 被复制表`
        
    * 复制表的结构和数据
        1. `create table 表名 select * from 被复制表`
        
        2. 只复制部分数据：`create table 表名 select 字段名,... from 被复制表 where 筛选条件`
        
        3. 只复制部分结构：将筛选条件设为假
        
           ```mysql 
           # 分步复制一张表
           
           # 复制表结构
           create table 新表 like 旧表
           # 复制表的数据
           insert into 新表 select * from 旧表;
           ```
        
           
    * 跨库复制时需要添加库名做限定
5. 建库建表通用写法
    1. 先做删除同名表的操作：`drop 
    2. 再创建该表

## 字段数据类型
1. 分类
    * 数值型
        1. 整数
        2. 小数（定点数、浮点数）
    * 字符型
        1. 较短字符：char、varchar
        2. 较长字符：text、blob（较长的二进制数据）
    * 日期型

2. 数值型
    * 整数：
        1. 按字节数分为多种类型
        2. 在类型后加`unsingend`可设置为无符号，（默认是有符号）。
        3. 如果存入数值超出了类型的范围，则存入临界值
    * 小数
        1. 浮点型：精度浮动，使用double(m,d)..等声明
        2. 定点型：精度更高，使用dec(m,d)进行声明，范围与double型相同，建议使用
        3. d：小数位；m:整数位+小数位
        4. m、d都可以省略，但是dec省略后有默认值:(10,0)de
        5. 精度要求较高则使用定点型
    * 类型选择原则
        1. 在能保存数值的条件下，越简单越小越好

3. 字符型
    * char和varchar
        1. 用法： varchar(m) , M 指最多保存的字符数
        2. 两者区别 
            1. char每次开辟固定空间，varchar根据存入字符大小开辟空间
            2. char的效率高，varchar相对较低
            3. 字符长度变化不大则使用char
    * enum枚举型
        1. 建表时指定会存入的值，后续存入时只能存入对应的数据
    * binary类型
        1. 保存二进制类型

4. 日期型
    * datetime类型
        1. 保存日期和时间
        2. 不受时区影响
    * timetamp类型
        1. 保存时间戳（日期+时间）
        2. 受时区影响

## 常见约束
1. 概述
    * 约束是一种限制，用于限制表中的数据
    * 约束的目的是为了保证表中的数据的准确和可靠性

2. 六大约束
    * 非空约束（not null)：保证字段的值不能为空
    * 默认约束（default)：保证字段有默认值
    * 主键约束（primary key)：
        1. 保证该字段的值具有唯一性，并且非空
        2. 一个表中只能有一个主键，或者没有
        3. 可以设置组合主键，即多个字段的组合作为主键（不是其中每个字段都是主键），但不推荐。
    * 唯一约束（unique)：保证字段的值唯一，可以为空
    * 检查约束（check)：`MySQL不支持`
    * 外键约束（foreign key）：
        1. 用于限制两个表之间的关系，用于保证字段的值必须来自于主表中关联字段的值
        2. 在从表添加外键，引用主表的值，且类型需要一致或兼容
        3. 主表中的关联列必须是主键或唯一键
        4. 插入数据时，先插入主表，再插入从表；删除数据时，先删除从表，再删除主表（或级联删除）

3. 添加约束
    * 添加时机
        1. 建表时
        2. 修改表时
    * 添加约束类型
        1. 列级约束
        2. 表级约束

4. 建表时添加约束
    * 列级约束
        1. 在字段类型后添加约束类型即可
        2. 不支持添加外键约束
    * 表级约束
        1. 语法
        ```
        (
        在字段声明的末尾，
        [constraint 约束名]  约束类型 字段名，
        //外键
        [constraint 约束名(索引名)] 外键类型（字段名） references 主表(字段名0)
        )
        ```
        2. 不支持默认、非空约束
    * 常用写法
        1. 除外键约束外，其他都使用列级约束
        2. 外键的约束名写法：字段名_从表名_主表名

5. 修改表时添加约束
    * 列级约束
        1. 使用修改字段数据类型的语法在末尾添加约束类型，不添则是删除约束类型。
    * 表级约束
        1. 使用添加字段的语法在末尾以表级约束的方式添加。
    
6. 修改表时删除约束
    1. 列级约束
        * `ALTER TABLE book MODIFY COLUMN book_name varchar(20) (不添加约束);`
    2. 表级约束
        * `ALTER TABLE book DROP primary key` //删除主键
        * `ALTER TABLE book DROP INDEX 索引名;`//删除唯一
        * `show INDEX FROM book;`//查询索引(约束名)
        * `alter table book drop forign key 外键约束名`//删除外键

7. 级联删除
    * 用于避免删除字段受到外键影响而无法正常删除。
    * 添加级联删除
        1. 在添加外键约束的语句末尾添加关键字：`on delete cascade`
    * 使用级联删除
        1. 可以直接删除主表中的外键数据
        2. 删除的是主表中的数据，同时将从表中相关联的数据全部删除

8. 级联置空
    * 避免级联删除时删除从表中的数据
    * 添加级联置空
        1. 在外键约束语句末尾添加关键字：`on delete set null`
    * 使用级联置空
        1. 同样直接删除主表中的外键数据
        2. 效果是在删除主表中数据同时，将从表的外键字段中相关数据置为空

## 标识列（自增长列）
1. 概述
    * 自增长列，可以不用手动的插入值，系统提供默认的序列值
    * 设置自增长列必须是一个key(包括主键、外键、唯一键)，且字段类型只能为数值型
    * 一个表至多有一个自增长列

2. 建表时设置标识列
    * 和添加约束一样，在末尾添加关键字`auto_increment`

3. 修改表时设置标识列
    * 和添加约束时一样，在其末尾添加
    
4. 设置自增长起始值，和增长值
    * 查看:`SHOW VARIABLES LIKE '%auto_increment%';`
    * MySQL只支持设置增长值：`SET auto_increment_increment=3;`
    * 起始值设置：插入语句第一条设置起始值，之后使用自增长列